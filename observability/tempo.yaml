# --- Global Server Settings ---
server:
  # The port where Tempo exposes its HTTP footprint (metrics, health checks, and API).
  # Default is usually 3200.
  http_listen_port: 3200

# --- Ingestion Layer (The Entry Point) ---
distributor:
  receivers:
    otlp:
      protocols:
        # Enables the OpenTelemetry gRPC receiver. 
        # 0.0.0.0:4317 allows it to listen on all network interfaces.
        grpc:
          endpoint: "0.0.0.0:4317"
        # Enables the OpenTelemetry HTTP receiver, typically used by web apps 
        # or environments where gRPC is restricted.
        http:
          endpoint: "0.0.0.0:4318"

# --- Processing Layer (The "Wait Room") ---
ingester:
  # How long to wait for more spans after a trace has seen no activity 
  # before considering it "done" and eligible to be cut into a block.
  trace_idle_period: 10s
  
  # Max size of an individual data block in memory before it is flushed to the WAL/Backend.
  max_block_bytes: 1_000_000
  
  # Max time a block can remain open in the ingester before being flushed, 
  # even if it hasn't reached 'max_block_bytes'.
  max_block_duration: 5m

# --- Optimization Layer (The Housekeeper) ---
compactor:
  compaction:
    # How often the compactor groups smaller blocks into larger, more searchable ones.
    compaction_window: 1h
    
    # The maximum size a single compacted block can reach.
    max_block_bytes: 100_000_000
    
    # Total time to keep raw trace data before it is deleted. 
    # Note: 1h is very shortâ€”usually used for testing.
    block_retention: 1h
    
    # How long to keep the original (uncompacted) blocks after a 
    # successful compaction before deleting them.
    compacted_block_retention: 10m

# --- Persistence Layer (Where the data lives) ---
storage:
  trace:
    # Defines where the traces are saved. 'local' is for disk storage (Filesystem).
    # In production, this is often 's3', 'gcs', or 'azure'.
    backend: local
    
    # Write Ahead Log (WAL) settings. 
    # This records incoming traces immediately to prevent data loss if the process crashes.
    wal:
      path: /tmp/tempo/wal
    
    # The final destination for completed/compacted trace blocks.
    local:
      path: /tmp/tempo/blocks